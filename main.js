(()=>{"use strict";var e=document.querySelector("#card-template").content,t=document.querySelector(".places__list");function o(t,o,r,n){var c=e.querySelector(".places__item").cloneNode(!0),a=c.querySelector(".card__delete-button"),u=c.querySelector(".card__like-button"),i=c.querySelector(".card__image");return c.querySelector(".card__image").src=t.link,c.querySelector(".card__image").alt=t.name,c.querySelector(".card__title").textContent=t.name,a.addEventListener("click",o),i.addEventListener("click",n),u.addEventListener("click",r),c}var r=function(e){e.target.classList.toggle("card__like-button_is-active")};function n(e){var t,o=e.target.closest(".places__item"),r=card.dataset.cardApi;t=c+card+"/"+r,fetch(t,{method:"DELETE",headers:{authorization:a,"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("error: ".concat(e.status))})),o.remove()}var c="https://nomoreparties.co",a=" 5142ff40-1fc4-41f7-80bd-cdb4eaf0110c";fetch("https://nomoreparties.co/v1/wff-cohort-1/cards",{headers:{authorization:" 5142ff40-1fc4-41f7-80bd-cdb4eaf0110c"}}).then((function(e){return e.json()})).then((function(e){console.log(e)})),fetch("https://nomoreparties.co/v1/wff-cohort-1/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"5142ff40-1fc4-41f7-80bd-cdb4eaf0110c"}}).then((function(e){return e.json()})).then((function(e){var t=e.name,o=e.about,r=e.avatar,n=e._id;e.cohort,document.querySelector(".header__name").textContent=t,document.querySelector(".header__about").textContent=o,document.querySelector(".avatar").src=r,localStorage.setItem("_id",n)})).catch((function(e){return console.error(e)})),fetch("https://nomoreparties.co/v1/wff-cohort-1/cards").then((function(e){return e.json()})).then((function(e){console.log(e)}));var u=function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("popup__input_type_error"),o.classList.remove("popup__error_visible"),o.textContent=""};function i(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove("popup__button_disabled"),t.disabled=!1):(t.classList.add("popup__button_disabled"),t.disabled=!0)}var p=function(e){e.classList.add("popup_is-animated"),setTimeout((function(){e.classList.add("popup_is-opened")}),100),document.addEventListener("keydown",s)},l=function(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",s)},s=function(e){"Escape"===e.code&&l(document.querySelector(".popup_is-opened"))},d=function(e){e.target===e.currentTarget&&l(document.querySelector(".popup_is-opened"))},_=document.querySelector(".places__list"),f=document.querySelector(".profile__edit-button"),m=document.querySelector(".profile__add-button"),v=document.querySelector(".popup__image"),y=document.querySelector(".popup__caption"),h=document.querySelectorAll(".popup"),S=document.querySelector(".popup_type_new-card"),q=document.querySelector(".popup_type_image"),b=document.querySelector(".popup_type_edit"),g=document.querySelector(".profile__title"),k=document.querySelector(".profile__description"),E=document.querySelector(".popup__input_type_name"),L=document.querySelector(".popup__input_type_description"),C=document.querySelectorAll(".popup__close"),x=document.querySelector(".popup__button"),j=function(e){p(q),v.src=e.target.src,v.alt=e.target.alt,y.textContent=e.target.alt};document.querySelector('form[name="edit-profile"]').addEventListener("submit",(function(e){e.preventDefault();var t=E.value,o=L.value,r=document.querySelector(".profile__title"),n=document.querySelector(".profile__description");r.textContent=t,n.textContent=o,E.value="",L.value="",l(b)}));var A=document.querySelector('form[name="new-place"]'),w=A.querySelector(".popup__input_type_card-name"),T=A.querySelector(".popup__input_type_url");A.addEventListener("submit",(function(e){e.preventDefault();var t={name:w.value,link:T.value};w.value="",T.value="";var c=o(t,n,r,j);_.prepend(c),l(S)})),C.forEach((function(e){e.addEventListener("click",(function(e){l(e.target.closest(".popup"))}))})),h.forEach((function(e){e.addEventListener("click",d)})),f.addEventListener("click",(function(){p(b),E.setAttribute("value",g.textContent),L.setAttribute("value",k.textContent)})),m.addEventListener("click",(function(e){e.preventDefault(),p(S)})),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){!function(e){t.append(e)}(o(e,n,r,j))}));var z={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:".popup__button_disabled",inputErrorClass:".popup__input_type_error",errorClass:".popup__error_visible"};!function(e){Array.from(document.querySelectorAll("".concat(e.formSelector))).forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(".popup__input")),o=e.querySelector(".popup__button");i(t,o),t.forEach((function(r){r.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity("Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы"):t.setCustomValidity(""),t.validity.valid?u(e,t):function(e,t,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("popup__input_type_error"),r.textContent=o,r.classList.add("popup__error_visible")}(e,t,t.validationMessage)}(e,r),i(t,o)}))}))}(e)}))}(z);var D=document.querySelector(".profile__image"),B=document.querySelector(".popup_type_change_avatar"),I=B.querySelector(".popup__close"),M=document.querySelector('form[name="new-avatar"]'),N=M.querySelector(".popup__input_type_url");D.addEventListener("click",(function(){p(B)})),I.addEventListener("click",(function(){l(B)})),M.addEventListener("submit",(function(e){var t,o;e.preventDefault(),x.classList.add("button_visible"),(t=N.value,o=c+"/v1/wff-cohort-1"+avatar,fetch(o,{method:"PATCH",headers:{authorization:a,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(e){return e.json()})).catch((function(e){console.log(e)}))).then((function(e){D.style.backgroundImage=url("".concat(e.avatar))})),M.reset(),l(B),function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector));i(o,e.querySelector(t.submitButtonSelector)),o.forEach((function(t){u(e,t)}))}(M,z)}))})();